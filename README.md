# å®æ—¶å¤šä¿¡å·ç»˜å›¾ç³»ç»Ÿ

åŸºäº Python NiceGUI å’Œ ECharts çš„å®æ—¶å¤šä¿¡å·ç»˜å›¾ç³»ç»Ÿï¼Œæ”¯æŒå¤šä¸ªä¿¡å·çš„å®æ—¶æ•°æ®å¯è§†åŒ–ã€‚

> **v2.1 æšä¸¾å€¼æ”¯æŒ** - æ–°å¢æšä¸¾ç±»å‹ä¿¡å·æ”¯æŒï¼Œå¯æ˜¾ç¤ºçŠ¶æ€ä¿¡å·å’Œå¼€å…³é‡

## âœ¨ åŠŸèƒ½ç‰¹æ€§

### æ•°æ®å¤„ç†
- âœ… **ç»Ÿä¸€æ•°æ®æ¥å£**ï¼šæ‰€æœ‰æ•°æ®ä½¿ç”¨ DataFrame æ ¼å¼
- âœ… **åŒæ¨¡å¼æ›´æ–°**ï¼šæ”¯æŒå…¨é‡æ›´æ–°ï¼ˆ`update_data`ï¼‰å’Œå¢é‡æ·»åŠ ï¼ˆ`append_data`ï¼‰
- âœ… **è‡ªåŠ¨æ—¶é—´çª—å£**ï¼šå†…ç½®ç¼“å†²åŒºç®¡ç†ï¼Œè‡ªåŠ¨è£å‰ªè¶…å‡ºçª—å£çš„æ•°æ®
- âœ… **ä¸åŒä¿¡å·å‘¨æœŸ**ï¼šæ¯ä¸ªä¿¡å·ç‹¬ç«‹é‡‡æ ·å‘¨æœŸï¼ˆ1x/2x/3x/5x å€æ•°ï¼‰
- âœ… **æšä¸¾å€¼æ”¯æŒ**ï¼šæ”¯æŒæšä¸¾ç±»å‹ä¿¡å·ï¼ˆçŠ¶æ€ä¿¡å·ï¼‰ï¼Œå¯é…ç½®æšä¸¾å€¼å’Œæ–‡æœ¬æ ‡ç­¾

### æ•°æ®å¯è§†åŒ–
- âœ… **å®æ—¶æ•°æ®æ›´æ–°**ï¼šæ”¯æŒ 50-1000ms å¯è°ƒæ›´æ–°é¢‘ç‡
- âœ… **å¤šå­å›¾å¸ƒå±€**ï¼šæ”¯æŒæœ€å¤š 20 ä¸ªä¿¡å·ä¸Šä¸‹æ’åˆ—æ˜¾ç¤º
- âœ… **ç©ºå¿ƒåœ†ç‚¹æ ‡è®°**ï¼šæ•°å€¼ä¿¡å·æ›²çº¿ä¸Šæ˜¾ç¤ºç©ºå¿ƒåœ†å½¢æ•°æ®ç‚¹
- âœ… **é˜¶æ¢¯å›¾æ˜¾ç¤º**ï¼šæšä¸¾ä¿¡å·ä½¿ç”¨é˜¶æ¢¯å›¾å±•ç¤ºçŠ¶æ€å˜åŒ–
- âœ… **è´¯ç©¿æŒ‡ç¤ºçº¿**ï¼šé¼ æ ‡æ‚¬åœæ—¶æ˜¾ç¤ºè´¯ç©¿æ‰€æœ‰å­å›¾çš„æ—¶é—´æŒ‡ç¤ºçº¿
- âœ… **æ™ºèƒ½ Tooltip**ï¼šæ•°å€¼ä¿¡å·æ˜¾ç¤ºç²¾ç¡®æ•°å€¼ï¼Œæšä¸¾ä¿¡å·æ˜¾ç¤ºæ–‡æœ¬æ ‡ç­¾
- âœ… **è‡ªé€‚åº”é«˜åº¦**ï¼šæ ¹æ®ä¿¡å·æ•°é‡åŠ¨æ€è°ƒæ•´å­å›¾é«˜åº¦
- âœ… **æ»šåŠ¨æ—¶é—´çª—å£**ï¼šé»˜è®¤æ˜¾ç¤ºæœ€è¿‘ 60 ç§’çš„æ•°æ®

### ç”¨æˆ·ç•Œé¢
- âœ… **å‚æ•°é…ç½®**ï¼šå¯è°ƒæ•´ä¿¡å·æ•°é‡ï¼ˆ1-20ï¼‰ã€æ›´æ–°é¢‘ç‡ã€é‡‡æ ·ç‡
- âœ… **ä¿¡å·ä¿¡æ¯é¢æ¿**ï¼šæ˜¾ç¤ºæ¯ä¸ªä¿¡å·çš„ç±»å‹ã€å‘¨æœŸã€é‡‡æ ·ç‡ã€æšä¸¾å€¼å®šä¹‰ç­‰è¯¦ç»†ä¿¡æ¯
- âœ… **å¯åŠ¨/åœæ­¢/é‡ç½®**ï¼šå®Œæ•´çš„æ§åˆ¶åŠŸèƒ½

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### æ–¹å¼1ï¼šå¯åŠ¨ Web ç•Œé¢ï¼ˆæ¨èï¼‰

```bash
python main.py
```

ç„¶ååœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼š`http://localhost:8080`

### æ–¹å¼2ï¼šè¿è¡Œç¤ºä¾‹ä»£ç 

```bash
python example_usage.py
```

ç¤ºä¾‹åŒ…å« 4 ä¸ªåœºæ™¯ï¼š
1. æ‰¹é‡ç”Ÿæˆæ•°æ®å¹¶æ›´æ–°
2. é€ç‚¹ç”Ÿæˆæ•°æ®å¹¶å¢é‡æ·»åŠ 
3. æ··åˆä½¿ç”¨ï¼ˆæ‰¹é‡åŠ è½½ + å¢é‡æ›´æ–°ï¼‰
4. æ¸…ç©ºå’Œé‡ç½®æ“ä½œ

### æ–¹å¼3ï¼šè‡ªå®šä¹‰ä½¿ç”¨

```python
from data_generator import DataGenerator
from realtime_plot import RealtimePlot

# åˆå§‹åŒ–ï¼ˆé»˜è®¤æœ€åä¸¤ä¸ªä¿¡å·ä¸ºæšä¸¾ç±»å‹ï¼‰
generator = DataGenerator(num_signals=4, base_sample_rate=5.0)

# æ„å»ºä¿¡å·ç±»å‹é…ç½®
signal_types = {}
for i, params in enumerate(generator.signal_params):
    signal_name = f'signal_{i+1}'
    if params['type'] == 'enum':
        signal_types[signal_name] = {
            'type': 'enum',
            'enum_labels': params['enum_labels']
        }
    else:
        signal_types[signal_name] = {'type': 'numeric'}

plot = RealtimePlot(num_signals=4, window_seconds=60.0, signal_types=signal_types)

# æ‰¹é‡ç”Ÿæˆå¹¶æ›´æ–°
data = generator.generate_batch_data(100)
plot.update_data(data)

# å¢é‡æ·»åŠ 
new_data = generator.generate_next_data()
plot.append_data(new_data)
```

æ›´å¤šè¯¦æƒ…è¯·æŸ¥çœ‹ [QUICKSTART.md](QUICKSTART.md)

## ğŸ“¦ æ ¸å¿ƒæ¨¡å—

### 1. RealtimePlotï¼ˆç»˜å›¾æ§ä»¶ï¼‰

```python
from realtime_plot import RealtimePlot

plot = RealtimePlot(num_signals=4, window_seconds=60.0)

# API æ¥å£
plot.update_data(df)       # å®Œå…¨æ›´æ–°ï¼ˆæ›¿æ¢æ‰€æœ‰æ•°æ®ï¼‰
plot.append_data(df)       # å¢é‡æ·»åŠ ï¼ˆè¿½åŠ æ–°æ•°æ®ï¼‰
plot.clear_data()          # æ¸…ç©ºæ‰€æœ‰æ•°æ®
plot.get_buffered_data()   # è·å–å½“å‰ç¼“å­˜æ•°æ®
plot.get_option()          # è·å– ECharts é…ç½®
```

**ç‰¹æ€§ï¼š**
- å†…ç½®æ•°æ®ç¼“å†²åŒºç®¡ç†
- è‡ªåŠ¨æ—¶é—´çª—å£è£å‰ªï¼ˆèŠ‚çœå†…å­˜ï¼‰
- æ•°æ®è‡ªåŠ¨æ’åº
- æ”¯æŒå¢é‡å’Œå…¨é‡æ›´æ–°

### 2. DataGeneratorï¼ˆæ•°æ®ç”Ÿæˆå™¨ï¼‰

```python
from data_generator import DataGenerator

generator = DataGenerator(num_signals=4, base_sample_rate=5.0)

# API æ¥å£
generator.generate_next_data()        # ç”Ÿæˆå•ä¸ªæ•°æ®ç‚¹
generator.generate_batch_data(100)    # æ‰¹é‡ç”Ÿæˆ
generator.get_signal_info()           # è·å–ä¿¡å·å‚æ•°ä¿¡æ¯
generator.get_all_data()              # è·å–æ‰€æœ‰ç´¯ç§¯æ•°æ®
generator.get_recent_data(60.0)       # è·å–æœ€è¿‘ N ç§’æ•°æ®
generator.reset()                     # é‡ç½®ï¼ˆä¿ç•™é…ç½®ï¼‰
```

**ç‰¹æ€§ï¼š**
- æ¯ä¸ªä¿¡å·ç‹¬ç«‹é‡‡æ ·å‘¨æœŸï¼ˆ1x/2x/3x/5xï¼‰
- éšæœºç”Ÿæˆé¢‘ç‡ã€ç›¸ä½ã€å¹…åº¦ã€å™ªå£°
- æ”¯æŒé€ç‚¹å’Œæ‰¹é‡ç”Ÿæˆ
- å¯æŸ¥è¯¢ä¿¡å·å‚æ•°ä¿¡æ¯

## ğŸ“Š æ•°æ®æ ¼å¼è§„èŒƒ

æ‰€æœ‰æ•°æ®æ¥å£ä½¿ç”¨ç»Ÿä¸€çš„ DataFrame æ ¼å¼ï¼š

```python
import pandas as pd
from datetime import datetime

data = pd.DataFrame({
    'timestamp': [datetime.now(), ...],  # å¿…é¡»ï¼šdatetime ç±»å‹
    'signal_1': [1.0, 2.0, ...],        # ä¿¡å· 1 çš„æ•°å€¼
    'signal_2': [3.0, 4.0, ...],        # ä¿¡å· 2 çš„æ•°å€¼
    # ... æ›´å¤šä¿¡å·
})
```

**æ³¨æ„äº‹é¡¹ï¼š**
- `timestamp` åˆ—å¿…é¡»ä¸º `datetime` ç±»å‹
- ä¿¡å·åˆ—å‘½åè§„èŒƒï¼š`signal_1`, `signal_2`, ..., `signal_N`
- æ•°å€¼åˆ—åº”ä¸º `float` ç±»å‹

## ğŸ¯ æ ¸å¿ƒç‰¹æ€§è¯´æ˜

### æšä¸¾å€¼é…ç½®ä¸æ˜¾ç¤º

ç³»ç»Ÿæ”¯æŒæšä¸¾ç±»å‹çš„ä¿¡å·ï¼ˆå¦‚çŠ¶æ€ä¿¡å·ã€å¼€å…³é‡ç­‰ï¼‰ï¼Œé»˜è®¤æƒ…å†µä¸‹æœ€åä¸¤ä¸ªä¿¡å·ä¸ºæšä¸¾ç±»å‹ã€‚

**ç‰¹æ€§ï¼š**
- **é˜¶æ¢¯å›¾æ˜¾ç¤º**ï¼šæšä¸¾ä¿¡å·ä½¿ç”¨é˜¶æ¢¯å›¾ï¼ˆstep lineï¼‰å±•ç¤ºçŠ¶æ€å˜åŒ–
- **ç¦»æ•£åˆ»åº¦**ï¼šYè½´æ˜¾ç¤ºç¦»æ•£çš„çŠ¶æ€å€¼
- **æ–‡æœ¬æ ‡ç­¾**ï¼šTooltip ä¸­æ˜¾ç¤ºæšä¸¾å€¼çš„æ–‡æœ¬å«ä¹‰è€Œéæ•°å­—
- **çŠ¶æ€è½¬æ¢**ï¼šè‡ªåŠ¨æ¨¡æ‹ŸçŠ¶æ€è½¬æ¢ï¼ˆå¯é…ç½®è½¬æ¢æ¦‚ç‡ï¼‰

**è‡ªå®šä¹‰æšä¸¾ä¿¡å·ï¼š**

```python
# æŒ‡å®šå“ªäº›ä¿¡å·ä¸ºæšä¸¾ç±»å‹ï¼ˆç´¢å¼•ä»0å¼€å§‹ï¼‰
generator = DataGenerator(
    num_signals=4, 
    base_sample_rate=100.0,
    enum_signal_indices=[2, 3]  # signal_3 å’Œ signal_4 ä¸ºæšä¸¾ç±»å‹
)
```

**å†…ç½®æšä¸¾ç±»å‹ï¼š**
- `default`: 4ä¸ªçŠ¶æ€ï¼ˆOFF, IDLE, RUNNING, ERRORï¼‰
- `boolean`: 2ä¸ªçŠ¶æ€ï¼ˆOFF, ONï¼‰
- `level`: 3ä¸ªçŠ¶æ€ï¼ˆä½, ä¸­, é«˜ï¼‰

**ä¿¡å·ä¿¡æ¯é¢æ¿**æ˜¾ç¤ºï¼š
- ä¿¡å·ç±»å‹ï¼ˆæ•°å€¼/æšä¸¾ï¼‰
- æšä¸¾å€¼å®šä¹‰ï¼ˆå€¼:æ ‡ç­¾ï¼‰
- æšä¸¾ä¿¡å·ä»¥é»„è‰²èƒŒæ™¯é«˜äº®æ˜¾ç¤º

### ä¸åŒä¿¡å·ä¸åŒå‘¨æœŸ

4ä¸ªä¿¡å·çš„é‡‡æ ·å‘¨æœŸå›ºå®šä¸º **20msã€50msã€100msã€200ms**ï¼š

```python
# åŸºç¡€é‡‡æ ·ç‡ 100Hz (10msåŸºç¡€å‘¨æœŸ)
Signal 1: é‡‡æ ·å‘¨æœŸ 20ms  (å‘¨æœŸå€æ•° 2)  â†’ æœ‰æ•ˆé‡‡æ ·ç‡ 50 Hz
Signal 2: é‡‡æ ·å‘¨æœŸ 50ms  (å‘¨æœŸå€æ•° 5)  â†’ æœ‰æ•ˆé‡‡æ ·ç‡ 20 Hz
Signal 3: é‡‡æ ·å‘¨æœŸ 100ms (å‘¨æœŸå€æ•° 10) â†’ æœ‰æ•ˆé‡‡æ ·ç‡ 10 Hz
Signal 4: é‡‡æ ·å‘¨æœŸ 200ms (å‘¨æœŸå€æ•° 20) â†’ æœ‰æ•ˆé‡‡æ ·ç‡ 5 Hz
```

**é‡è¦**ï¼šéé‡‡æ ·æ—¶é—´ç‚¹çš„å€¼ä¸º `NaN`ï¼ˆç©ºå€¼ï¼‰ï¼Œåœ¨å›¾è¡¨ä¸Šæ˜¾ç¤ºä¸ºæ–­ç‚¹ï¼Œä¸è¿›è¡Œå¡«å……ã€‚è¿™æ ·èƒ½å‡†ç¡®åæ˜ çœŸå®çš„é‡‡æ ·æƒ…å†µã€‚

```python
# ç¤ºä¾‹ï¼šæŸ¥çœ‹æ•°æ®ä¸­çš„ NaN å€¼
data = generator.generate_batch_data(100)
print(data['signal_1'].isna().sum())  # è¾“å‡ºç©ºå€¼æ•°é‡
```

æŸ¥çœ‹ä¿¡å·å‚æ•°ä¿¡æ¯ï¼š

```python
info = generator.get_signal_info()
print(info)
```

è¾“å‡ºç¤ºä¾‹ï¼š
```
  signal  sample_period_ms  frequency  amplitude  offset  effective_sample_rate
signal_1              20.0   0.287270   2.463988     0.0                   50.0
signal_2              50.0   0.178009   1.116167     0.3                   20.0
signal_3             100.0   0.400558   1.041169     0.6                   10.0
signal_4             200.0   0.516221   1.363650     0.9                    5.0
```

### è‡ªåŠ¨æ—¶é—´çª—å£ç®¡ç†

ç»˜å›¾æ§ä»¶è‡ªåŠ¨ç®¡ç†æ—¶é—´çª—å£ï¼Œè¶…å‡ºçª—å£çš„æ•°æ®ä¼šè¢«è‡ªåŠ¨è£å‰ªï¼š

```python
# åˆå§‹åŒ– 60 ç§’æ—¶é—´çª—å£
plot = RealtimePlot(num_signals=4, window_seconds=60.0)

# æ·»åŠ æ•°æ®æ—¶ï¼Œè‡ªåŠ¨ä¿ç•™æœ€è¿‘ 60 ç§’çš„æ•°æ®
plot.append_data(new_data)  # æ—§æ•°æ®è‡ªåŠ¨è£å‰ª
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
graph/
â”œâ”€â”€ main.py                 # ä¸»ç¨‹åºï¼ˆWeb ç•Œé¢ï¼‰
â”œâ”€â”€ realtime_plot.py        # ç»˜å›¾æ§ä»¶
â”œâ”€â”€ data_generator.py       # æ•°æ®ç”Ÿæˆå™¨
â”œâ”€â”€ example_usage.py        # ä½¿ç”¨ç¤ºä¾‹
â”œâ”€â”€ requirements.txt        # ä¾èµ–é…ç½®
â”œâ”€â”€ README.md              # æœ¬æ–‡æ¡£
â””â”€â”€ QUICKSTART.md          # å¿«é€Ÿå¼€å§‹æŒ‡å—
```

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **NiceGUI** (v1.4+)ï¼šPython Web UI æ¡†æ¶
- **ECharts** (v5.4+)ï¼šé«˜æ€§èƒ½æ•°æ®å¯è§†åŒ–åº“ï¼ˆå‰ç«¯æ¸²æŸ“ï¼‰
- **Pandas** (v2.0+)ï¼šæ•°æ®å¤„ç†å’Œåˆ†æ
- **NumPy** (v1.24+)ï¼šæ•°å€¼è®¡ç®—

## ğŸ“– å…¸å‹ä½¿ç”¨åœºæ™¯

### åœºæ™¯1ï¼šå®æ—¶æ•°æ®æµ

```python
generator = DataGenerator(num_signals=4, base_sample_rate=5.0)
plot = RealtimePlot(num_signals=4, window_seconds=60.0)

# å®æ—¶å¾ªç¯
while True:
    new_data = generator.generate_next_data()
    plot.append_data(new_data)
    # ... æ›´æ–°æ˜¾ç¤º
```

### åœºæ™¯2ï¼šåŠ è½½å†å²æ•°æ®

```python
# å…ˆåŠ è½½å¤§é‡å†å²æ•°æ®
historical_data = generator.generate_batch_data(num_points=1000)
plot.update_data(historical_data)

# ç„¶ååˆ‡æ¢åˆ°å®æ—¶æ¨¡å¼
while True:
    new_data = generator.generate_next_data()
    plot.append_data(new_data)
```

### åœºæ™¯3ï¼šå‘¨æœŸæ€§æ‰¹é‡æ›´æ–°

```python
while True:
    batch = generator.generate_batch_data(num_points=10)
    plot.append_data(batch)
    time.sleep(1)
```

## ğŸ¨ ç•Œé¢æ“ä½œ

- **ä¿¡å·æ•°é‡**ï¼šè®¾ç½®è¦æ˜¾ç¤ºçš„ä¿¡å·æ•°é‡ï¼ˆ1-20ï¼‰
- **æ›´æ–°é¢‘ç‡**ï¼šè®¾ç½®å›¾è¡¨åˆ·æ–°é¢‘ç‡ï¼ˆ50-1000msï¼‰
- **åŸºç¡€é‡‡æ ·ç‡**ï¼šè®¾ç½®æ•°æ®ç”Ÿæˆé¢‘ç‡ï¼ˆ0.1-100Hzï¼‰
- **å¯åŠ¨æŒ‰é’®**ï¼šå¼€å§‹å®æ—¶ç»˜å›¾
- **åœæ­¢æŒ‰é’®**ï¼šæš‚åœæ›´æ–°
- **é‡ç½®æŒ‰é’®**ï¼šæ¸…ç©ºæ•°æ®å¹¶é‡æ–°åˆå§‹åŒ–

## ğŸ” è°ƒè¯•æŠ€å·§

### æŸ¥çœ‹ä¿¡å·å‚æ•°

```python
info = generator.get_signal_info()
print(info)
```

### æŸ¥çœ‹ç¼“å­˜æ•°æ®

```python
buffered = plot.get_buffered_data()
print(f"ç¼“å­˜æ•°æ®ç‚¹æ•°: {len(buffered)}")
print(f"æ—¶é—´èŒƒå›´: {buffered['timestamp'].min()} åˆ° {buffered['timestamp'].max()}")
```

### æ£€æŸ¥æ•°æ®æ ¼å¼

```python
data = generator.generate_next_data()
print(data.dtypes)  # æ£€æŸ¥æ•°æ®ç±»å‹
print(data.columns)  # æ£€æŸ¥åˆ—å
```

## ğŸ“ ç‰ˆæœ¬å†å²

### v2.1 (2025-11-18) - æšä¸¾å€¼æ”¯æŒ
- âœ… æ”¯æŒæšä¸¾ç±»å‹ä¿¡å·ï¼ˆçŠ¶æ€ä¿¡å·ã€å¼€å…³é‡ç­‰ï¼‰
- âœ… æšä¸¾ä¿¡å·ä½¿ç”¨é˜¶æ¢¯å›¾æ˜¾ç¤ºï¼Œæ¸…æ™°å±•ç¤ºçŠ¶æ€å˜åŒ–
- âœ… Tooltip æ˜¾ç¤ºæšä¸¾å€¼çš„æ–‡æœ¬æ ‡ç­¾
- âœ… ä¿¡å·ä¿¡æ¯é¢æ¿æ˜¾ç¤ºä¿¡å·ç±»å‹å’Œæšä¸¾å€¼å®šä¹‰
- âœ… å†…ç½®ä¸‰ç§æšä¸¾ç±»å‹ï¼ˆdefault, boolean, levelï¼‰

### v2.0 (2025-11-17) - é‡æ„ç‰ˆæœ¬
- âœ… å°è£…ç»˜å›¾æ§ä»¶ï¼Œæä¾› `update_data` å’Œ `append_data` æ¥å£
- âœ… é‡æ„æ•°æ®ç”Ÿæˆå™¨ï¼Œæ”¯æŒä¸åŒä¿¡å·ä¸åŒå‘¨æœŸ
- âœ… æ·»åŠ ä¿¡å·å‚æ•°ä¿¡æ¯é¢æ¿
- âœ… ç»Ÿä¸€ä½¿ç”¨ DataFrame æ•°æ®æ ¼å¼
- âœ… å†…ç½®æ•°æ®ç¼“å†²åŒºå’Œæ—¶é—´çª—å£ç®¡ç†
- âœ… æ›²çº¿ä¸Šæ˜¾ç¤ºç©ºå¿ƒåœ†ç‚¹æ ‡è®°

### v1.0 - åˆå§‹ç‰ˆæœ¬
- åŸºç¡€å®æ—¶å¤šä¿¡å·ç»˜å›¾åŠŸèƒ½
- ECharts å¤šå­å›¾å¸ƒå±€
- æ•°æ®ç”Ÿæˆå™¨

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

---

**å¼€å‘æ—¥æœŸ**: 2025-11-18  
**ç‰ˆæœ¬**: v2.1  
**çŠ¶æ€**: âœ… ç”Ÿäº§å°±ç»ª
