# 动态图表测试程序使用说明

## 启动程序

```bash
python test_dynamic_chart.py
```

程序将在 `http://localhost:8082` 启动

## 功能特性

### ✅ 1. 完整的页面布局
- **页眉**：显示系统标题和实时时钟
- **页脚**：显示版权和系统信息
- **左侧边栏**：信号选择面板（带边框）
- **主体区域**：Tab页（图表显示 + 系统信息）

### ✅ 2. 动态信号选择
- 左侧边栏可以选择要显示的信号（多选）
- 支持6种信号类型：
  - 🌡️ **温度传感器**（数值）- 缓慢变化的正弦波
  - 📊 **压力传感器**（数值）- 快速振荡
  - ⚡ **电压信号**（数值）- 阶跃变化
  - 🔋 **电流信号**（数值）- 指数上升/下降
  - 🚦 **设备状态**（枚举）- OFF/IDLE/RUN/ALARM
  - ⚙️ **转速**（数值）- 线性上升

- **全选/清除**按钮快速操作
- 选择变化后，图表自动更新
- 初始状态下图表为空

### ✅ 3. 实时数据生成与滚动显示
- 点击"开始"按钮启动数据生成
- **采样频率**：10 Hz（每100ms生成一个数据点）
- **滚动窗口**：只保留最近30秒的数据
- 实时刷新曲线，自动滚动
- 数据点数和时间跨度实时更新

### ✅ 4. 停止后显示全部历史
- 点击"停止"按钮
- 自动切换显示全部历史数据
- 统计信息更新为"全部历史"
- 可以缩放查看任意时间段

## 使用流程

### 第一步：选择信号
1. 在左侧边栏勾选要监控的信号
2. 可以使用"全选"/"清除"按钮
3. 至少选择1个信号
4. 图表区域会自动更新（初始为空）

### 第二步：开始运行
1. 点击"开始"按钮（绿色）
2. 状态变为"正在运行..."（绿色）
3. 数据开始实时生成和显示
4. 信号选择被锁定（不可修改）

### 第三步：观察数据
- 图表自动滚动显示最近30秒
- 统计信息实时更新：
  - 数据点数：显示/总计
  - 时间跨度：显示/总计
- 可以使用鼠标悬停查看详细数据
- 可以拖动或缩放时间轴

### 第四步：停止并查看历史
1. 点击"停止"按钮（红色）
2. 状态变为"已停止"（红色）
3. 自动显示全部历史数据
4. 统计信息变为"全部历史"
5. 可以重新选择信号并再次运行

## 界面说明

### 控制面板
```
🎮 控制面板
├─ 数据点数: 显示/总计
├─ 时间跨度: 显示/总计（秒）
├─ 信号数量: X
├─ [开始] 按钮（绿色，启动数据生成）
├─ [停止] 按钮（红色，停止并显示全部）
└─ 状态: 准备就绪/正在运行.../已停止
```

### Tab页
- **图表显示**：主要的图表区域
- **系统信息**：功能说明、信号说明、操作步骤、技术特性

### 信号选择面板
```
📊 信号选择
├─ [全选] [清除]
├─ ☐ 温度传感器 (°C)
├─ ☐ 压力传感器 (Pa)
├─ ☐ 电压信号 (V)
├─ ☐ 电流信号 (A)
├─ ☐ 设备状态 (状态)
├─ ☐ 转速 (RPM)
└─ 💡 使用提示
```

## 信号行为说明

| 信号名称 | 类型 | 行为描述 | 数值范围 |
|---------|------|---------|---------|
| 温度传感器 | 数值 | 正弦波 + 噪声 | 20-30°C |
| 压力传感器 | 数值 | 快速振荡 | 100325-102325 Pa |
| 电压信号 | 数值 | 5V ⇄ 3.3V 阶跃 | 3.2-5.1V |
| 电流信号 | 数值 | 指数上升/下降周期 | 0-0.5A |
| 设备状态 | 枚举 | OFF→IDLE→RUN→ALARM | 4个状态 |
| 转速 | 数值 | 线性上升 + 噪声 | 1000+ RPM |

## 技术参数

- **采样频率**：10 Hz (100ms间隔)
- **滚动窗口**：30秒（运行时）
- **数据缓存**：无限制（保存全部历史）
- **最大信号数**：6个
- **端口**：8082
- **自动刷新**：是

## 快捷操作

### 快速测试所有信号
1. 点击"全选"
2. 点击"开始"
3. 运行约30-60秒
4. 点击"停止"查看全部

### 测试单个信号
1. 只选择一个信号
2. 点击"开始"运行
3. 观察该信号的特征

### 测试组合信号
1. 选择感兴趣的信号组合
2. 运行并观察它们的关系
3. 可以尝试不同组合

## 性能说明

- **内存占用**：随历史数据增长（建议运行<5分钟）
- **CPU占用**：低（定时器更新）
- **浏览器兼容**：Chrome、Firefox、Edge
- **响应速度**：实时（<100ms延迟）

## 常见问题

### Q: 为什么点击"开始"没反应？
A: 请先在左侧选择至少一个信号

### Q: 如何只看某个时间段的数据？
A: 点击"停止"后，使用鼠标拖动底部滑块或Ctrl+滚轮缩放

### Q: 可以运行多久？
A: 理论上无限制，但建议<5分钟以避免内存占用过大

### Q: 如何重新开始？
A: 点击"停止"，重新选择信号（可选），再点击"开始"

### Q: 数据会保存吗？
A: 不会，停止后刷新页面数据会清空

## 调试模式

打开浏览器控制台（F12）可以看到：
- Chart instance initialization logs
- 图表实例信息
- 数据更新日志

## 已知特性

✅ 支持多信号同时显示
✅ 支持数值和枚举信号混合
✅ 自动调整数据点显示密度
✅ 实例隔离，支持未来扩展为多图表
✅ 响应式布局（适应不同屏幕）

## 扩展建议

想要自定义？可以修改：
- `all_signals`：添加更多信号类型
- `generate_data_point()`：修改数据生成算法
- `window_seconds=30.0`：修改滚动窗口大小
- 定时器间隔：`ui.timer(0.1, ...)`

---

**版本**: 1.0  
**端口**: 8082  
**状态**: ✅ 运行中

